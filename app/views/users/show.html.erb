<%= provide(:title, @user.name) %>
<!--　ヘッダーの検索バーで検索して結果がヒットした時は非表示にする -->
<% unless @feed_items.present? %>

    <section style="margin-top: -50px;">
     <%= gravatar_for @user %>
     <h3 style="font-weight: bold;"><%= @user.name %></h3>
    </section><br>

  <div style="text-align: center;">
   <%= link_to "本をさがす", search_books_path, class: "btn-border" %>
   <%= link_to "読んでいる本", reading_books_path, class: "btn-border" %>
   <%= link_to "読んだ本", readed_books_path, class: "btn-border" %>
   <%= link_to "読みたい本", want_books_path, class: "btn-border" %>
   <%= link_to "読書メモを読む", impressions_page_path, class: "btn-border" %>
   <%= link_to "読んだ本一覧", readed_books_table_path, class: "btn-border" %>
  </div>
<hr style="border-top: double;">
 <h3 style="font-weight: bold; text-align: center;">今読んでいる本</h3>
<hr style="border-bottom: double;">
 <% if @books.any? %> 
  <%= render @books %> 
 <% else %> 
  <p style="text-align: center;">現在読んでいる本はありません</p>
 <% end %>

 <%# 表 %>
<table class="table-style" style="margin: 0 auto">
 <thead>
  <tr>
   <th><% now = Time.current %><%= now.month %>月に読んだ本</th>
   <th><% now = Time.current %><%= now.month %>月に読んだページ数</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td><%= @now_month_count %>冊</td>
   <td><%= @month_page_count %>ページ</td>
  </tr>
 </tbody>
</table>

<table class="table-style" style="margin: 0 auto">
 <thead>
  <tr>
   <th><% now = Time.current %><%= now.prev_month.mon %>月に読んだ本</th>
   <th><% now = Time.current %><%= now.prev_month.mon %>月に読んだページ数</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td><%= @last_month_count %>冊</td>
   <td><%= @last_month_page_count %>ページ</td>
  </tr>
 </tbody>
</table>

 <table class="table-style" style="margin: 0 auto">
  <tr>
   <th>読んだ月(月集計)</th>
   <th>読んだ数(月集計)</th>
  </tr>
 <tr>
  <td><% @month_book_count.keys.each do |month| %>
    <%= month %>月<br>
  <% end %></td>
  <td><% @month_book_count.values.each do |count| %>
   <%= count %>冊<br>
  <% end %></td>
 </tr>
</table>

<table class="table-style" style="margin: 0 auto">
 <tr>
  <th>読んだ年(年集計)</th>
  <th>読んだ数(年集計)</th>
 </tr>
 <tr>
  <td><% @year_book_count.keys.each do |year| %>
    <%= year %>年<br>
  <% end %></td>
  <td><% @year_book_count.values.each do |book| %>
    <%= book %>冊<br>
  <% end %></td>
 </tr>
</table>

<% if current_user.admin? %>
<hr style="border-top: double;">
 <% if @impressions.any? %>
 <h3 style="font-weight: bold;">読書メモ （投稿数：<%= @impressions.count %>）</h3>
 <hr style="border-bottom: double;">
  <%= paginate @impressions %>
  <%= render @impressions %>
  <% end %>
 <% end %>
<% end %>
<!--　ここまで　-->

<!--　検索結果ありの場合のみ表示 -->
<% unless @feed_items.nil? %>
 <header class="navbar navbar-fixed-top navbar-default">
  <div class="container">
      <div class="navbar-header">
         <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
           <span class="sr-only">Toggle navigation</span>
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
         </button>
          <%= link_to "REREC", root_path, id: "logo" %>
       </div>
  <nav>
    <ul id="navbar" class="nav navbar-nav navbar-right navbar-collapse collapse">
      <% if logged_in? %>
        <li class="search-nav">
          <%= form_with url: user_path(current_user), method: :get, local: true do %>
         <div class="input-group">
          <%= search_field_tag "i", params[:i], class: "form-control", placeholder: "読書メモ検索" %>
           <span class="input-group-btn">
            <%= submit_tag "検索", class: "btn btn-default" %>
           </span>
         </div>
        <% end %>
        </li>
        <li>
         <%= link_to "マイページ", current_user %>
        </li>
         <% end %>
        <li>
         <%= link_to "本をさがす", search_books_path %>
        </li>
        <li style="margin-top: -20px;"> 
         <% if current_user.admin? %>
　        <%= link_to "ユーザー管理画面", users_path %>
         <% end %>
        </li>
        <li>
         <%= link_to "ログアウト", logout_path, method: :delete %>
        </li>
      </ul>
    </nav>
   </div>
  </header>
  <hr style="margin-top: -70px;">
   <h3 style="font-weight: bold; text-align: center;">投稿メモ検索結果</h3>
  <hr>
   <%= render @feed_items %>
  <% end %>
<!--　ここまで　-->  